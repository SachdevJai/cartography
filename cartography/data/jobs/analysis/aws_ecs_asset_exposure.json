{
  "statements": [
    {
      "query": "MATCH (t:ECSTask) WHERE t.exposed_internet IS NOT NULL WITH t LIMIT $LIMIT_SIZE REMOVE t.exposed_internet, t.exposed_internet_type",
      "iterative": true,
      "iterationsize": 1000
    },
    {
      "__comment": "Mark tasks as internet exposed when their host EC2 instance is internet exposed",
      "query": "MATCH (t:ECSTask)<-[:HAS_TASK]-(ci:ECSContainerInstance) MATCH (i:EC2Instance{instanceid: ci.ec2_instance_id}) WHERE i.exposed_internet = true SET t.exposed_internet = true, t.exposed_internet_type = i.exposed_internet_type",
      "iterative": false
    }
  ],
  "name": "AWS ECS internet exposure"
}
